---
_vm_count_dict:
  separate: 3
  ha: 3
  ha-recover: 3
  ha-recover-noquorum: 3
  all-in-one: 1
  node-etcd-client: 4
  default: 2

vm_count: "{{ _vm_count_dict[mode | d('default')] }}"

# Get pod metadata / CI vars from environment

ci_job_id: "{{ lookup('ansible.builtin.env', 'CI_JOB_ID', default=undefined) }}"
ci_job_name: "{{ lookup('ansible.builtin.env', 'CI_JOB_NAME', default=undefined) }}"
pod_name: "{{ lookup('ansible.builtin.env', 'POD_NAME', default=undefined) }}"
pod_uid: "{{ lookup('ansible.builtin.env', 'POD_UID', default=undefined) }}"
pod_namespace: "{{ lookup('ansible.builtin.env', 'POD_NAMESPACE', default=undefined) }}"
