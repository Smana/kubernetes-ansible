---
cert_files:
  master:
  - "{{ etcd_cert_dir }}/member-{{ inventory_hostname }}.pem"
  - "{{ etcd_cert_dir }}/member-{{ inventory_hostname }}-key.pem"
  - "{{ etcd_cert_dir }}/admin-{{ inventory_hostname }}.pem"
  - "{{ etcd_cert_dir }}/admin-{{ inventory_hostname }}-key.pem"
  node:
  - "{{ etcd_cert_dir}}/node-{{ inventory_hostname }}.pem"
  - "{{ etcd_cert_dir}}/node-{{ inventory_hostname }}-key.pem"
nodes_needs_certs: "{{ (kube_network_plugin in ['calico', 'flannel', 'cilium'] or cilium_deploy_additionally | default(false)) and (kube_network_plugin != 'calico' or calico_datastore == 'etcd') }}"
gen_certs: "{{ ((groups['gen_master_certs_True'] + (nodes_needs_certs | ansible.builtin.ternary(groups['gen_node_certs_True'], []))) | length == 0) or ((etcd_cert_dir + '/ca.pem') not in (etcdcert_master.files | map(attribute='path'))) }}"
