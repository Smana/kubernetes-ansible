---
- name: Copy OCI RBAC Manifest
  copy:
    src: "oci-rbac.yml"
    dest: "{{ kube_config_dir }}/oci-rbac.yml"
    mode: 0640
  when:
  - cloud_provider is defined
  - cloud_provider == 'oci'
  - inventory_hostname == first_kube_control_plane

- name: Apply OCI RBAC
  kube:
    kubectl: "{{ bin_dir }}/kubectl"
    filename: "{{ kube_config_dir }}/oci-rbac.yml"
  when:
  - cloud_provider is defined
  - cloud_provider == 'oci'
  - inventory_hostname == first_kube_control_plane
