---
- name: Kubernetes Dashboard | Lay Down Dasboard Template
  template:
      src={{item.file}}
      dest={{kube_config_dir}}/{{item.file}}
  with_items:
    - {file: kubernetes-dashboard.yml, type: deployment, name: kubernetes-dashboard}
  register: dashboard_deployment_manifest
  when: inventory_hostname == groups['kube-master'][0]

- name: Kubernetes Dashboard | Start Dashboard Resource
  kube:
    name: "{{item.item.name}}"
    namespace: "{{dashboard_namespace}}"
    kubectl: "{{bin_dir}}/kubectl"
    resource: "{{item.item.type}}"
    filename: "{{kube_config_dir}}/{{item.item.file}}"
    state: "{{item.changed | ternary('latest','present') }}"
  with_items: "{{ dashboard_deployment_manifest.changed  }}"
  when: inventory_hostname == groups['kube-master'][0]
