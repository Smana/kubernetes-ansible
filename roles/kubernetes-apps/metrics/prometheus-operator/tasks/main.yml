---
- name: "Prometheus Operator | make directory for configs"
  file: 'path="{{ dst_dir }}" state=directory'

- name: "Prometheus Operator | Copy manifests"
  copy:
    src: "{{ item }}"
    dest: "{{ dst_dir }}/{{ item }}"
  with_items:
     - prometheus-operator-cluster-role-binding.yaml
     - prometheus-operator-cluster-role.yaml
     - prometheus-operator-service-account.yaml
     - prometheus-operator-service.yaml
     - prometheus-operator.yaml
  run_once: true

- name: "Prometheus Operator | Create namespace"
  command: "{{ item }}"
  with_items:
     - "{{ bin_dir }}/kubectl create namespace {{ monitoring_namespace }} "
  ignore_errors: yes
  run_once: true

- name: "Prometheus Operator | Create operator"
  command: "{{ item }}"
  with_items:
    - "{{ bin_dir }}/kubectl apply --namespace {{ monitoring_namespace }} -f {{ dst_dir }}"
  run_once: true



