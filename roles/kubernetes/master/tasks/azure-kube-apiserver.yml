---
- name: Get hyperkube
  copy:
    remote_src: yes
    src: "{{ bin_dir }}/kubectl"
    dest: "{{ bin_dir }}/hyperkube"
    mode: 0755

- name: Create kube-api-server service
  template:
    src: kube-apiserver.service.j2
    dest: /etc/systemd/system/kube-apiserver.service

- name: Reload systemd units
  command: systemctl daemon-reload

- name: Restart kube-apiserver
  service:
    name: kube-apiserver
    state: restarted
    enabled: yes
  notify: Master | Restart apiserver
  tags:
    - kube-apiserver

