---
- name: Macvlan | restart network
  command: /bin/true
  notify:
    - Macvlan | reload network
  when: not ansible_facts.os_family in ["Flatcar", "Flatcar Container Linux by Kinvolk"]

- name: Macvlan | reload network
  service:
    name: >-
      {% if ansible_facts.os_family == "RedHat" -%}
      network
      {%- elif ansible_facts.distribution == "Ubuntu" and ansible_facts.distribution_release == "bionic" -%}
      systemd-networkd
      {%- elif ansible_facts.os_family == "Debian" -%}
      networking
      {%- endif %}
    state: restarted
  when: not ansible_facts.os_family in ["Flatcar", "Flatcar Container Linux by Kinvolk"] and kube_network_plugin not in ['canal', 'calico']
