---

- name: "Fan | setup dhcp daemon service"
  template:
    src: "cni-dhcp.service.j2"
    dest: "/etc/systemd/system/cni-dhcp.service"
  when: "{{ ansible_service_mgr == 'systemd' }}"

- name: "Fan | setup dhcp daemon socket activation"
  template:
    src: "cni-dhcp.socket.j2"
    dest: "/etc/systemd/system/cni-dhcp.socket"
  when: "{{ ansible_service_mgr == 'systemd' }}"

- name: "Fan | enable services"
  service:
    name: "{{ item }}"
    state: "reloaded"
    enabled: true
  with_items:
    - "cni-dhcp.socket"
    - "cni-dhcp.service"
  when: "{{ ansible_service_mgr == 'systemd' }}"
